<!doctype html>
<html lang=zh_cn>
<meta charset=utf-8>
<title>程序员工具</title>
 <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"/>
<meta name=keywords content=程序员工具>
<meta name=description content=程序员工具>
<link rel="shortcut icon" href=/favicon.ico>
<link href=https://cdn.bootcss.com/font-awesome/5.10.0-11/css/all.min.css rel=stylesheet>
<link href=https://cdn.bootcss.com/jsoneditor/6.1.0/jsoneditor.min.css rel=stylesheet>
<link href=https://cdn.bootcss.com/highlight.js/9.15.9/styles/idea.min.css rel="stylesheet">
<link rel=stylesheet href=/xiaoniutool/static/css/style.css>
<style>
    .container {
        max-width: 100%
    }
    pre {
        overflow: auto
    }
    .jsoneditor-poweredBy {
        display: none
    }
    div.jsoneditor-menu,
    .jsoneditor-modal .pico-modal-header {
        background-color: #1E90FF
    }
    div.jsoneditor,
    div.jsoneditor-menu {
        border: 1px solid #1E90FF
    }
    .select {
        flex-shrink: 1;
        width: 100%
    }
    .options {
        width: 200px;
        margin: 0 24px;
    }
    #input_size {
        max-width: 111px
    }
    .image {
        width: 280px;
        height: 280px;
        background-color: #f3f3f3;
        clear: both;
        display: block;
        margin: auto
    }
    #msg_list {
        padding: 8px 16px;
        height: 70vh;
        font-size: 14px;
        overflow: auto
    }
</style>
<aside>
    <h1 class=logo><a href="/">XiaoNiu工具</a></h1>
    <nav class=side-nav>
        <p>JSON
        <ul>
            <li><a href=/xiaoniutool/zh/json.html>JSON格式化</a>
            <li><a href=/xiaoniutool/zh/json2xml.html>JSON/XML转换</a>
            <li><a href=/xiaoniutool/zh/json2yaml.html>JSON/YAML转换</a>
            <li><a href=/xiaoniutool/zh/json2go.html>JSON转Go Struct</a>
        </ul>
        <p>Base64/Hash
        <ul>
            <li><a href=/xiaoniutool/zh/base64.html>Base64编码解码</a>
            <li><a href=/xiaoniutool/zh/image2base64.html>图片Base64编码</a>
            <li><a href=/xiaoniutool/zh/hash.html>Hash计算</a>
            <li><a href=/xiaoniutool/zh/hashfile.html>文件Hash计算</a>
        </ul>
        <p>转换
        <ul>
            <li><a href=/xiaoniutool/zh/timestamp.html>Unix时间戳</a>
            <li><a href=/xiaoniutool/zh/color.html>颜色值转换</a>
            <li><a href=/xiaoniutool/zh/number.html>进制转换</a>
            <li><a href=/xiaoniutool/zh/url.html>URL编码解码</a>
            <li><a href=/xiaoniutool/zh/unicode.html>Unicode编码转换</a>
            <li><a href=/xiaoniutool/zh/pdf2img.html>PDF转图片</a>
        </ul>
        <p>加密
        <ul>
            <li><a href=/xiaoniutool/zh/encrypt_aes.html>AES加密解密</a>
            <li><a href=/xiaoniutool/zh/encrypt_des.html>DES加密解密</a>
            <li><a href=/xiaoniutool/zh/encrypt_rsa.html>RSA加密解密</a>
        </ul>
        <p>其他
        <ul>
            <li><a href=/xiaoniutool/zh/tinyimg.html>图片压缩</a>
            <li><a href=/xiaoniutool/zh/qrcode.html>二维码制作</a>
            <li><a href=/xiaoniutool/zh/websocket.html>WebSocket测试</a>
            <li><a href=/xiaoniutool/zh/regex.html>正则表达式测试</a>
        </ul>
    </nav>
</aside>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?c88dc783ad09061423b4245401cfb826";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><main>
    <div class=container>
        <h1>图片Base64编码</h1>
        <div class="file fullwidth mt-2"><span class=file-cta><input id=input_file class=file-input type=file
                    accept=image/png,image/jpeg,image/gif,image/jpg onchange=onChange(this)>
                <span class=file-icon><i class="fas fa-upload"></i></span><span class=file-button>选择一张图片</span></span>
            <span id=file_name class=file-name></span>
        </div>
        <div id=img_input class="textarea mt-2" contenteditable=true style=min-height:18em;height:auto;overflow:auto>
        </div>
        <div class="content-center mt-2"><button class=button onclick=base64ToImage()>
                <i class="fa fa-arrow-up"></i><span>Base64还原图片</span></button>
            <button class=button onclick=cleanup()>
                <span>清空</span></button>
        </div><textarea id=area_base64 class="textarea mt-2" rows=20 onpaste=setTimeout(base64ToImage,1)></textarea>
    </div>
</main>
<script>
function formatSize(size, len, units) {
    let unit;
    units = units || ['B', 'K', 'M', 'G', 'TB'];
    while ((unit = units.shift()) && size > 1024) {
        size = size / 1024;
    }
    return (unit === 'B' ? size : size.toFixed(len === undefined ? 2 : len)) + unit;
}
let img_input = document.getElementById('img_input');
let file_name = document.getElementById('file_name');
let area_base64 = document.getElementById('area_base64');

function base64ToImage() {
    let base64 = area_base64.value;
    if (!base64.startsWith('data:image')) {
        base64 = 'data:image/jpeg;base64,' + base64
    }
    img_input.innerHTML = ` < img src = "${base64}" > `;
}

function cleanup() {
    img_input.innerText = '';
    file_name.innerText = '';
    area_base64.value = '';
}

function onChange(e) {
    loadImage(e.files[0]);
    e.value = null;
}

function loadImage(file) {
    let reader = new FileReader();
    reader.onload = function(e) {
        file_name.innerHTML = file.name + ` & nbsp; & nbsp; <a> [$ {
            formatSize(file.size)
        }] </a>`; img_input.innerHTML = `<img src="${e.target.result}">`; area_base64.value = e.target.result; }; reader.readAsDataURL(file); }
    document.addEventListener('paste', function (event) { if (event.clipboardData || event.originalEvent) { let data = (event.clipboardData || event.originalEvent.clipboardData); if (data.items) { let items = data.items, len = items.length, blob = null; for (let i = 0; i < len; i++) { if (items[i].type.indexOf("image") !== -1) { blob = items[i].getAsFile(); loadImage(blob); } } } } })
</script>